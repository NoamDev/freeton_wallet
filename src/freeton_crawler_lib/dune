; generated by drom from package skeleton 'library'

(library
  (name freeton_crawler_lib)
  (public_name freeton_crawler_lib)
  (wrapped false)
  (libraries lwt freeton_ocaml_sdk freeton_crawler_db_versions ez_pgocaml ez_cmdliner lwt.unix)
  (optional)
  
  )


(rule
    (targets version.ml)
    (deps (:script version.mlt) package.toml)
    (action (with-stdout-to %{targets} (run %{ocaml} unix.cma %{script}))))

(documentation
  (package freeton_crawler_lib))

(rule
 (targets db.ml)
 (deps
  (:src db.pp.ml)
  updated.ml
  (env_var PGDATABASE)
  (env_var PGCUSTOM_CONVERTERS_CONFIG))
 (mode promote)
 (action
  (with-stdout-to %{targets}
    (run %{lib:pgocaml_ppx:ppx.exe} %{src}))))

(rule
 (targets db_utils.ml)
 (deps
  (:src db_utils.pp.ml)
  updated.ml
  (env_var PGDATABASE)
  (env_var PGCUSTOM_CONVERTERS_CONFIG))
 (mode promote)
 (action
  (with-stdout-to %{targets}
    (run %{lib:pgocaml_ppx:ppx.exe} %{src}))))

(rule
  (targets updated.ml)
  (deps
    ../freeton_crawler_db_versions/main.ml
    %{bin:freeton_crawler_db_updater})
  (mode promote)
  (action
      (run %{bin:freeton_crawler_db_updater} updated.ml))
)

